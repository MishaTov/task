{% extends 'base.html' %}

{% block content %}
    {{ super() }}

<div class="p-4">
    <div class="d-flex">
        <h1>{{ task.subject }}</h1>
        {% if current_user.username == task.created_by %}
            <button type="button" class="btn btn-secondary btn-sm align-self-center" style="height: 30px; margin: 0px 0px 0px 10px" id="edit-task">Edit task</button>
        {% endif %}
    </div>
    <div class="position-relative top-0 end-0 d-flex">
        <div class="position-relative" id="task-label">{{ task.label }}</div>
        <span class="fs-5 position-relative" style="color: {{ color[task.label] }}; top: -4px; left: 3px" id="color-label"> ‚óè </span>
    </div>
{#    <div class="position-relative">#}
    <div class="position-relative" style="bottom: 0px" id="time-label" url="{{ url_for('checklabel', task_uid=task.uid) }}">
    <span class="fw-bold">Due to:</span> {{ task.deadline.strftime('%d %B %Y %H:%M') }}
    <br>
    <span class="fw-bold">Time remaining:</span> <span data-deadline="{{ task.deadline.strftime('%Y-%m-%dT%H:%M:%S') }}" id="time-left"></span>
    </div>
    <div class="d-inline-flex" id="accept-reject-button" url="{{ url_for('acceptreject', task_uid=task.uid) }}" cur_user="{{ current_user.username }}" task_uid="{{ task.uid }}">
        {% if current_user in task.users %}
            <button type="button" class="btn btn-primary visually-hidden" id="accept-task" style="margin-top: 5px; padding-top: 3px; padding-bottom: 3px; width: 80px; text-align: center">Accept</button>
            <button type="button" class="btn btn-danger" id="reject-task" style="margin-top: 5px; padding-top: 3px; padding-bottom: 3px; width: 80px; text-align: center">Reject</button>
        {% else %}
            <button type="button" class="btn btn-primary" id="accept-task" style="margin-top: 5px; padding-top: 3px; padding-bottom: 3px; width: 80px; text-align: center">Accept</button>
            <button type="button" class="btn btn-danger visually-hidden" id="reject-task" style="margin-top: 5px; padding-top: 3px; padding-bottom: 3px; width: 80px; text-align: center">Reject</button>
        {% endif %}
    </div>
<br>
    <span class="d-inline-flex" id="assigned-users" style="margin-top: 5px">
        {% if task.users %}
            Assigned to: &nbsp
            {% for user in task.users %}
                <a class="link-underline link-underline-opacity-0" href="{{ url_for('profile', username=user.username) }}">{{ user.username }}</a>
                {% if not loop.last %}, &nbsp{% endif %}
            {% endfor %}
        {% else %}
            No one does this task
        {%  endif %}
    </span>
{#    </div>#}
    <div class="text-break w-50" style="margin: 80px 0px 0px 0px">
        <h3>Description:</h3>
        {{ task.description }}
    </div>
    <div class="mt-3"><span class="fw-bold">Attachments:</span>
        {% for file in task.files %}
            <a href="{{ url_for('downloadfile', file_uid=file.uid) }}" class="btn btn-outline-dark d-flex d-inline-flex" style="height: 30px; max-width: 500px; font-size: 14px; padding: 2px 5px; align-items: center">{{ file.filename }}</a>
        {% endfor %}
    </div>
    <p class="mt-5"><span class="fw-bold">Created:</span> {{ task.created.strftime('%d %B %Y') }} by <a class="link-underline link-underline-opacity-0" href="{{ url_for('profile', username=task.created_by) }}">{{ task.created_by }}</a></p>
</div>

<script src="{{ url_for('static', filename='left_time.js') }}"></script>
<script src="{{ url_for('static', filename='accept_reject.js') }}"></script>
<script src="{{ url_for('static', filename='task_label.js') }}"></script>
<script src="{{ url_for('static', filename='test.js') }}"></script>


{% endblock %}